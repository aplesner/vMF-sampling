# W&B Sweep Configuration for vMF Sampling
# This sweep explores different dimensions and implementations

method: grid
program: run_sweep.py

# Sweep settings
project: "vmf-sampling"
name: "vmf-sampling-comprehensive"
description: "Comprehensive sweep over vMF sampling implementations, dimensions, and devices"

parameters:
  # Sweep over dimensions
  dimension:
    values: [256, 512, 1024, 2048, 4096, 8192, 16384]
    
  # Sweep over implementations
  implementation:
    values: ["numpy", "scipy", "torch"]
    
  # Sweep over device types (torch will use both cpu/cuda, others ignore)
  device:
    value: "auto"
  #   values: ["auto", "cpu", "cuda"]
    
  # Vary concentration parameter
  kappa:
    value: 10.0
  #   values: [1.0, 5.0, 10.0, 20.0]
    
  # Fixed parameters for consistency
  num_samples:
    value: 2000
    
  seed:
    values: [1, 2, 3] 
    
# Optimize for mean benchmark time (faster is better)
metric:
  name: "benchmark/mean_time"
  goal: minimize

command:
  - python3
  - run_sweep.py
  - ${env_vars:VERBOSE=0,WANDB_QUIET=true}